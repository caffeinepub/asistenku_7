{
  "schemaVersion": "1.0.0",
  "projectStateVersion": 3,
  "summary": "Implement \"claim superadmin\" flow by adding stable backend methods (hasSuperadmin/claimSuperadmin) and wiring them to a new \"Claim Superadmin\" card on the existing Internal Login (Masuk Internal) page, under strict constraints about which files/pages may be modified.",
  "architectural_notes": [
    "Strict change constraints: do not modify landing page or Asistenku landing components; do not touch client/partner pages; no global refactor; do not change routing except ensuring existing internal login route.",
    "Only allowed files to change: backend/main.mo; the Internal Login (Masuk Internal) page file with the internal roles grid; one actor/frontend binding helper file (e.g., useActor.ts or equivalent).",
    "UI constraint: do not use the word \"service\"/\"Service\" anywhere in the UI.",
    "UX constraint: user must login via Internet Identity first (unchanged), then can click \"Claim Superadmin\" if available.",
    "Backend behavior constraints: first caller can claim and becomes ACTIVE immediately with no required name/email/WhatsApp fields; idempotent for existing superadmin; reject non-superadmin if already claimed."
  ],
  "known_issues": [],
  "isFixRequest": false,
  "existing_features": [
    {
      "id": "feature-in-the-existing-internal-login-page-file-frontend-src-pages-internal-internallogin-tsx-add-a-claim-superadmin-ui-block-tied-to-the-backend-methods-on-page-load-call-actor-hassuperadmin-store-state-as-hassuperadmin-boolean-null-while-hassuperadmin-null-show-a-small-loading-indicator-rendering-rules-if-hassuperadmin-false-render-a-card-at-the-top-of-the-role-grid-or-immediately-before-the-grid-with-title-claim-superadmin-description-only-available-once-after-it-is-claimed-this-card-disappears-button-claim-superadmin-if-hassuperadmin-true-do-not-render-the-card-at-all-interaction-the-user-must-complete-internet-identity-login-first-keep-the-existing-internet-identity-login-button-behavior-intact-then-they-can-click-claim-superadmin-if-shown-on-clicking-the-button-call-actor-claimsuperadmin-if-ok-true-refresh-hassuperadmin-by-calling-actor-hassuperadmin-again-or-perform-a-light-page-reload-limited-to-this-page-if-ok-false-display-the-backend-message-as-an-error-ui-wording-constraint-do-not-use-the-word-service-or-service-anywhere-on-this-page",
      "title": "In the existing Internal Login page file `frontend/src/pages/internal/InternalLogin.tsx`, add a \"Claim Superadmin\" UI block tied to the backend methods.\n\nOn page load:\n- Call `actor.hasSuperadmin()`.\n- Store state as `hasSuperadmin: boolean | null`.\n- While `hasSuperadmin === null`, show a small loading indicator.\n\nRendering rules:\n- If `hasSuperadmin === false`, render a card at the top of the role grid (or immediately before the grid) with:\n  - Title: \"Claim Superadmin\"\n  - Description: \"Only available once. After it is claimed, this card disappears.\"\n  - Button: \"Claim Superadmin\"\n- If `hasSuperadmin === true`, do not render the card at all.\n\nInteraction:\n- The user must complete Internet Identity login first (keep the existing Internet Identity login button behavior intact), then they can click \"Claim Superadmin\" (if shown).\n- On clicking the button, call `actor.claimSuperadmin()`.\n  - If `ok === true`, refresh `hasSuperadmin` by calling `actor.hasSuperadmin()` again (or perform a light page reload limited to this page).\n  - If `ok === false`, display the backend `message` as an error.\n\nUI wording constraint:\n- Do not use the word \"service\" or \"Service\" anywhere on this page.",
      "reqIds": [
        "REQ-2"
      ],
      "version": 1
    }
  ],
  "new_feature_requests": [
    {
      "id": "AR-1",
      "summary": "Backend: add stable hasSuperadmin() and claimSuperadmin() methods with specified superadmin-claim behavior",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-2",
      "summary": "Frontend: add \"Claim Superadmin\" card to Internal Login page that calls hasSuperadmin/claimSuperadmin and hides after claimed",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-3",
      "summary": "Frontend binding: update actor/helper hook to expose hasSuperadmin() and claimSuperadmin() to the UI",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-4",
      "summary": "In `backend/main.mo`, ensure the following methods exist with exactly these signatures (stable/public API):\n- `public query func hasSuperadmin() : async Bool`\n- `public shared({caller}) func claimSuperadmin() : async { ok: Bool; message: Text }`\n\nImplement behavior:\n- If no superadmin exists yet: set `caller` as the superadmin and mark it ACTIVE immediately (no name/email/WhatsApp requirements); return `{ ok = true; message = <non-empty success text> }`.\n- If a superadmin already exists and `caller` is that superadmin: return `{ ok = true; message = <idempotent success text> }`.\n- If a superadmin already exists and `caller` is not the superadmin: return `{ ok = false; message = <non-empty error text> }`.\n\nDo not add any required fields for superadmin such as name/email/WhatsApp.",
      "reqIds": [
        "REQ-1"
      ],
      "status": "pending"
    },
    {
      "id": "AR-6",
      "summary": "Update the single existing frontend canister binding/helper file `frontend/src/hooks/useActor.ts` (or equivalent within that same file only) so the Internal Login page can safely call `hasSuperadmin()` and `claimSuperadmin()` on the backend actor after Internet Identity login.\n\nThis must be done without global refactors and without changing routing; limit changes strictly to enabling these method calls from the Internal Login page.",
      "reqIds": [
        "REQ-3"
      ],
      "status": "pending"
    }
  ],
  "gameProjectType": "none",
  "projectName": "Wire Superadmin Claim Flow to Internal Login UI (Strict File/Scope Constraints)",
  "clarification_mode": "instant",
  "clarification_rounds": 0
}